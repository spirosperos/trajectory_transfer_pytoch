function tmpreturn = gravitational_forces(q, param)
  m = [0 0 0 0 0 0 0;];
  t1 = param.m7 * param.sp7x;
  t2 = q(7);
  t3 = sin(t2);
  t4 = t3 * t1;
  t5 = param.m7 * param.sp7y;
  t6 = cos(t2);
  t7 = t6 * t5;
  t10 = -param.sp5y * param.m5 + param.sp6z * param.m6 + t4 + t7;
  t11 = q(5);
  t12 = cos(t11);
  t13 = t12 * t10;
  t14 = t6 * t1;
  t15 = t3 * t5;
  t17 = -param.m6 * param.sp6x + t14 - t15;
  t18 = q(6);
  t19 = cos(t18);
  t20 = t19 * t17;
  t21 = param.d7 + param.sp7z;
  t23 = param.m6 * param.sp6y;
  t24 = param.m7 * t21 + t23;
  t25 = sin(t18);
  t26 = t25 * t24;
  t27 = param.sp5x * param.m5;
  t28 = t20 + t26 - t27;
  t29 = sin(t11);
  t30 = t29 * t28;
  t33 = param.sp3y * param.m3 - param.sp4z * param.m4 + t13 + t30;
  t34 = q(3);
  t35 = cos(t34);
  t36 = t35 * t33;
  t37 = t19 * t24;
  t38 = -t17;
  t39 = t25 * t38;
  t40 = param.d5 + param.d6;
  t43 = param.d5 + param.sp5z;
  t45 = param.sp4y * param.m4;
  t46 = param.m5 * t43 + param.m6 * t40 + param.m7 * t40 + t37 + t39 + t45;
  t47 = sin(t34);
  t48 = t47 * t46;
  t49 = q(4);
  t50 = sin(t49);
  t52 = t12 * t28;
  t53 = -t10;
  t55 = param.sp4x * param.m4;
  t56 = t29 * t53 + t52 + t55;
  t57 = t56 * t47;
  t58 = cos(t49);
  t64 = param.m3 * param.sp3x * t47 + param.sp1y * param.m1 + param.sp2z * param.m2 - t48 * t50 + t57 * t58 + t36;
  t65 = q(1);
  t66 = sin(t65);
  t68 = t50 * t46;
  t69 = t19 * t38;
  t72 = -param.m7 * t21 - t23;
  t73 = t25 * t72;
  t74 = t69 + t73 + t27;
  t76 = t29 * t10;
  t77 = t12 * t74 - t55 + t76;
  t78 = t58 * t77;
  t80 = -param.sp3x * param.m3 + t68 + t78;
  t82 = t47 * t33;
  t84 = param.sp2x * param.m2 + t35 * t80 + t82;
  t85 = q(2);
  t86 = cos(t85);
  t87 = t86 * t84;
  t88 = t50 * t77;
  t89 = t19 * t72;
  t90 = t25 * t17;
  t91 = -t40;
  t96 = -param.m5 * t43 + param.m6 * t91 + param.m7 * t91 - t45 + t89 + t90;
  t98 = -param.d3 - param.d4;
  t103 = -param.sp3z - param.d3;
  t105 = param.sp2y * param.m2;
  t106 = param.m3 * t103 + param.m4 * t98 + param.m5 * t98 + param.m6 * t98 + param.m7 * t98 + t58 * t96 - t105 + t88;
  t107 = sin(t85);
  t110 = -param.sp1x * param.m1 + t107 * t106 + t87;
  t111 = cos(t65);
  t114 = sin(param.gamma_base);
  t116 = cos(param.beta_base);
  t118 = sin(param.beta_base);
  m(1,1) = (t116 * t114 * (-t110 * t111 - t64 * t66) + (-t110 * t66 + t111 * t64) * t118) * param.g;
  t126 = t106 * t86 - t107 * t84;
  t130 = t58 * t46;
  t131 = -t98;
  t141 = cos(param.gamma_base);
  m(1,2) = (t116 * (-t114 * t66 * t126 + t141 * (-t107 * (-param.m3 * t103 + param.m4 * t131 + param.m5 * t131 + param.m6 * t131 + param.m7 * t131 + t50 * t56 + t105 + t130) + t87)) + t111 * t126 * t118) * param.g;
  t154 = param.m3 * param.sp3x * t35 - t35 * t46 * t50 + t35 * t56 * t58 - t82;
  t157 = -t47 * t80 + t36;
  t158 = t86 * t157;
  m(1,3) = (t116 * (t114 * (t111 * t154 - t158 * t66) + t141 * t107 * t157) + (t111 * t158 + t154 * t66) * t118) * param.g;
  t173 = -t48 * t58 - t50 * t57;
  t176 = t35 * (t130 - t88);
  t181 = t86 * t176 + t107 * (-t50 * t96 + t78);
  m(1,4) = (t116 * (t114 * (t111 * t173 - t181 * t66) + t141 * (t86 * (t56 * t58 - t68) + t107 * t176)) + (t111 * t181 + t173 * t66) * t118) * param.g;
  t198 = -t76 + t52;
  t201 = t12 * t53 - t30;
  t204 = t201 * t47 * t58 + t198 * t35;
  t207 = -t29 * t74 + t13;
  t211 = t207 * t35 * t58 + t198 * t47;
  t215 = t107 * t207 * t50 + t211 * t86;
  m(1,5) = (t116 * (t114 * (t111 * t204 - t215 * t66) + t141 * (t201 * t50 * t86 + t107 * t211)) + (t111 * t215 + t204 * t66) * t118) * param.g;
  t231 = -t90 + t37;
  t232 = t29 * t231;
  t234 = -t26 + t69;
  t240 = t12 * t231 * t47 * t58 - t234 * t47 * t50 + t232 * t35;
  t244 = t12 * (-t39 + t89);
  t249 = t35 * (t234 * t50 + t244 * t58) + t47 * t232;
  t256 = t86 * t249 + t107 * (t50 * t244 + t58 * (-t73 + t20));
  m(1,6) = (t116 * (t114 * (t111 * t240 - t256 * t66) + t141 * (t86 * (t12 * t231 * t50 + t234 * t58) + t107 * t249)) + (t111 * t256 + t240 * t66) * t118) * param.g;
  t275 = t14 - t15;
  t277 = -t4 - t7;
  t278 = t19 * t277;
  t280 = t12 * t275 + t278 * t29;
  t282 = -t277;
  t283 = t25 * t282;
  t289 = t12 * t278 - t275 * t29;
  t292 = -t283 * t47 * t50 + t289 * t47 * t58 + t280 * t35;
  t298 = t12 * t19 * t282 + t275 * t29;
  t303 = t35 * (t283 * t50 + t298 * t58) + t47 * t280;
  t310 = t86 * t303 + t107 * (t25 * t277 * t58 + t298 * t50);
  m(1,7) = (t116 * (t114 * (t111 * t292 - t310 * t66) + t141 * (t86 * (t283 * t58 + t289 * t50) + t107 * t303)) + (t111 * t310 + t292 * t66) * t118) * param.g;
  tmpreturn = m';
