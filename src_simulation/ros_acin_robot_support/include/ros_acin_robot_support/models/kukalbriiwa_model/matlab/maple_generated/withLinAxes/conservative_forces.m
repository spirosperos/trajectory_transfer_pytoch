function tmpreturn = conservative_forces(q, q_p, theta, param)
  m = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;];
  t3 = sin(param.gamma_base);
  t4 = cos(param.beta_base);
  t12 = param.K__a * (theta(1) - q(1));
  m(1,1) = t4 * t3 * param.g * (-param.m7 - param.m6 - param.m5 - param.m4 - param.m3 - param.m2 - param.m1 - param.ma - param.mb) + param.beta * q_p(1) - t12;
  t15 = sin(param.beta_base);
  t22 = param.K__b * (theta(2) - q(2));
  m(1,2) = t15 * (param.m7 + param.m6 + param.m5 + param.m4 + param.m3 + param.m2 + param.m1 + param.mb) * param.g + param.beta * q_p(2) - t22;
  t23 = param.sp7x * param.m7;
  t24 = q(9);
  t25 = sin(t24);
  t26 = t25 * t23;
  t27 = param.sp7y * param.m7;
  t28 = cos(t24);
  t29 = t28 * t27;
  t32 = param.m5 * param.sp5y - param.sp6z * param.m6 - t26 - t29;
  t33 = q(7);
  t34 = cos(t33);
  t35 = t34 * t32;
  t36 = t28 * t23;
  t37 = t27 * t25;
  t39 = param.m6 * param.sp6x - t36 + t37;
  t40 = q(8);
  t41 = cos(t40);
  t42 = t41 * t39;
  t43 = -param.sp7z - param.d7;
  t45 = param.m6 * param.sp6y;
  t46 = param.m7 * t43 - t45;
  t47 = sin(t40);
  t48 = t47 * t46;
  t49 = param.m5 * param.sp5x;
  t50 = t42 + t48 + t49;
  t51 = sin(t33);
  t52 = t51 * t50;
  t53 = param.m3 * param.sp3y;
  t54 = param.m4 * param.sp4z;
  t55 = t35 + t52 - t53 + t54;
  t56 = q(5);
  t57 = cos(t56);
  t61 = -param.m7 * t43 + t45;
  t62 = t41 * t61;
  t63 = t47 * t39;
  t64 = param.d5 + param.d6;
  t67 = param.d5 + param.sp5z;
  t69 = param.m4 * param.sp4y;
  t70 = param.m5 * t67 + param.m6 * t64 + param.m7 * t64 + t62 + t63 + t69;
  t71 = sin(t56);
  t72 = t71 * t70;
  t73 = q(6);
  t74 = sin(t73);
  t75 = t74 * t72;
  t76 = -t39;
  t77 = t41 * t76;
  t78 = t47 * t61;
  t79 = t77 + t78 - t49;
  t80 = t34 * t79;
  t81 = t51 * t32;
  t82 = param.m4 * param.sp4x;
  t83 = t80 + t81 + t82;
  t84 = t83 * t71;
  t85 = cos(t73);
  t86 = t85 * t84;
  t88 = param.sp3x * param.m3 * t71;
  t89 = param.m2 * param.sp2z;
  t90 = param.m1 * param.sp1y;
  t92 = q(3);
  t93 = sin(t92);
  t95 = t74 * t70;
  t96 = t34 * t50;
  t97 = -t32;
  t98 = t51 * t97;
  t99 = t96 + t98 - t82;
  t100 = t85 * t99;
  t102 = -param.m3 * param.sp3x + t100 + t95;
  t104 = t34 * t97;
  t105 = t51 * t79;
  t106 = t104 + t105 + t53 - t54;
  t107 = t71 * t106;
  t109 = param.m2 * param.sp2x + t102 * t57 + t107;
  t110 = q(4);
  t111 = cos(t110);
  t112 = t111 * t109;
  t113 = t74 * t99;
  t114 = t46 * t41;
  t115 = t47 * t76;
  t116 = -t64;
  t121 = -param.m5 * t67 + param.m6 * t116 + param.m7 * t116 + t114 + t115 - t69;
  t123 = -param.d3 - param.d4;
  t128 = -param.sp3z - param.d3;
  t130 = param.m2 * param.sp2y;
  t131 = param.m3 * t128 + param.m4 * t123 + param.m5 * t123 + param.m6 * t123 + param.m7 * t123 + t121 * t85 + t113 - t130;
  t132 = sin(t110);
  t135 = -param.sp1x * param.m1 + t131 * t132 + t112;
  t136 = cos(t92);
  t142 = t106 * t57;
  t153 = (theta(3) - t92) * param.K__1;
  m(1,3) = (t4 * t3 * (-t93 * (t55 * t57 + t75 - t86 - t88 - t89 - t90) + t136 * t135) + t15 * (-t93 * t135 + t136 * (t142 - t75 + t86 + t88 + t89 + t90))) * param.g + param.beta * q_p(3) - t153;
  t156 = -t109 * t132 + t111 * t131;
  t159 = cos(param.gamma_base);
  t161 = t85 * t70;
  t162 = -t123;
  t183 = (theta(4) - t110) * param.K__2;
  m(1,4) = (t4 * (t3 * t93 * t156 + (-t132 * (-param.m3 * t128 + param.m4 * t162 + param.m5 * t162 + param.m6 * t162 + param.m7 * t162 + t74 * t83 + t130 + t161) + t112) * t159) + t15 * t136 * t156) * param.g + param.beta * q_p(4) - t183;
  t186 = t74 * t57 * t70;
  t188 = t85 * t83 * t57;
  t190 = param.sp3x * param.m3 * t57;
  t194 = -t102 * t71 + t142;
  t195 = t111 * t194;
  t214 = (theta(5) - t56) * param.K__3;
  m(1,5) = (t4 * (t3 * (t136 * (-t55 * t71 + t186 - t188 - t190) + t93 * t195) + t132 * t194 * t159) + t15 * (t136 * t195 + t93 * (-t107 - t186 + t188 + t190))) * param.g + param.beta * q_p(5) - t214;
  t217 = t72 * t85 + t74 * t84;
  t220 = t57 * (t161 - t113);
  t225 = t111 * t220 + t132 * (-t121 * t74 + t100);
  t248 = (theta(6) - t73) * param.K__4;
  m(1,6) = (t4 * (t3 * (t136 * t217 + t225 * t93) + (t111 * (t85 * t83 - t95) + t220 * t132) * t159) + t15 * (t225 * t136 - t217 * t93)) * param.g + param.beta * q_p(6) - t248;
  t251 = -t105 + t35;
  t253 = t85 * t251 * t71;
  t256 = -t52 + t104;
  t259 = -t98 + t80;
  t261 = t256 * t57 * t85 + t259 * t71;
  t265 = t132 * t256 * t74 + t111 * t261;
  t288 = (theta(7) - t33) * param.K__5;
  m(1,7) = (t4 * (t3 * (t136 * (t57 * (-t81 + t96) - t253) + t93 * t265) + (t111 * t251 * t74 + t132 * t261) * t159) + t15 * (t136 * t265 + t93 * (t259 * t57 + t253))) * param.g + param.beta * q_p(7) - t288;
  t289 = -t63 + t114;
  t292 = -t78 + t42;
  t294 = t74 * t71 * t292;
  t295 = -t115 + t62;
  t298 = t85 * t34 * t295 * t71;
  t302 = t34 * t289;
  t306 = t51 * t295;
  t308 = t57 * (t292 * t74 + t302 * t85) + t71 * t306;
  t315 = t111 * t308 + t132 * (t74 * t302 + t85 * (-t48 + t77));
  t341 = (theta(8) - t40) * param.K__6;
  m(1,8) = (t4 * (t3 * (t136 * (t289 * t51 * t57 + t294 - t298) + t93 * t315) + (t111 * (t295 * t34 * t74 + t292 * t85) + t132 * t308) * t159) + t15 * (t136 * t315 + t93 * (t306 * t57 - t294 + t298))) * param.g + param.beta * q_p(8) - t341;
  t342 = -t36 + t37;
  t344 = t26 + t29;
  t345 = t41 * t344;
  t349 = t47 * t344;
  t351 = t74 * t71 * t349;
  t352 = -t344;
  t353 = t41 * t352;
  t356 = t34 * t353 + t342 * t51;
  t358 = t85 * t356 * t71;
  t363 = -t342;
  t365 = t34 * t345 + t363 * t51;
  t371 = t34 * t363 + t353 * t51;
  t373 = t57 * (t349 * t74 + t365 * t85) + t71 * t371;
  t380 = t111 * t373 + t132 * (t352 * t47 * t85 + t365 * t74);
  t405 = (theta(9) - t24) * param.K__7;
  m(1,9) = (t4 * (t3 * (t136 * (t57 * (t34 * t342 + t345 * t51) + t351 - t358) + t93 * t380) + (t111 * (t349 * t85 + t356 * t74) + t132 * t373) * t159) + t15 * (t136 * t380 + t93 * (t371 * t57 - t351 + t358))) * param.g + param.beta * q_p(9) - t405;
  m(1,10) = t12;
  m(1,11) = t22;
  m(1,12) = t153;
  m(1,13) = t183;
  m(1,14) = t214;
  m(1,15) = t248;
  m(1,16) = t288;
  m(1,17) = t341;
  m(1,18) = t405;
  tmpreturn = m';
